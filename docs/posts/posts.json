[
  {
    "path": "posts/2021-08-19-competing-risk-approach-to-peritonitis-in-malaysia/",
    "title": "Competing risk approach to peritonitis in Malaysia",
    "description": "Survival analysis beyond Kaplan-Meier",
    "author": [
      {
        "name": "WenYao, Mak",
        "url": "https://www.linkedin.com/in/mak-wen-yao-51148154/"
      }
    ],
    "date": "2021-08-19",
    "categories": [],
    "contents": "\r\nScientific poster on competiting risk analysis\r\n\r\n\r\n\r\nFigure 1: Some cool caption\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-08-19-competing-risk-approach-to-peritonitis-in-malaysia/0001.jpg",
    "last_modified": "2021-08-19T13:55:34+08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-08-16-gis-distribution-of-pharmacy-in-penang-malaysia/",
    "title": "GIS: Distribution of Pharmacy in Penang, Malaysia",
    "description": "How to use R to visualise places of interest (work in progress)",
    "author": [
      {
        "name": "WenYao, Mak",
        "url": "https://www.linkedin.com/in/mak-wen-yao-51148154/"
      }
    ],
    "date": "2021-08-16",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nVisualising Pharmacy Locations with R\r\nData Collection\r\nGIS package in R\r\nMapping pharmacies\r\n\r\nVisualising Pharmacy Locations with R\r\nThis is a side-project where new information will be continuously added\r\nThe motivation behind this project is that I wanted to visualise how competitive is in the retail pharmacy sector, especially in Penang.\r\nThis project utilises open-source data published on the Official Portal of Pharmaceutical Services Programme Register of Licenses, available here.\r\nDisclaimer: To err is human. If you find any mistakes on this post please kindly let me know. You can reach me via:\r\nData Collection\r\nInformation of all registered pharmacies (retail or wholesale) is manually collected from the website, filtering for License A (pharmacist license) in Penang state only. A total of 602 entries were collected. Among the important variables that I needed were (1) Name of the premise, (2) Address, and (3) Type of the business (retail, wholesale, or both).\r\nAs the file size is quite small, the .csv sheet is read via the read.csv() wrapper function. The data frame is given a name “PG” via\r\n\r\n\r\nPG <- read.csv(\"PGpharm.csv\")\r\n\r\n\r\n\r\nDisplaying the column names suggests that the information is sufficient for what I want to do here. (Note: the column names were written in Malay where ‘Nama.Premis’=‘Premise Name’ and ‘Alamat.Premis’=‘Premise Address’)\r\n\r\n\r\ncolnames(PG)\r\n\r\n\r\n [1] \"Bil.\"                     \"No..Daftar\"              \r\n [3] \"No..Lesen\"                \"Nama.Pemegang.Lesen\"     \r\n [5] \"Nama.Premis\"              \"Alamat.Premis\"           \r\n [7] \"Tarikh.Lesen.Dikeluarkan\" \"Tarikh.Kuatkuasa.Lesen\"  \r\n [9] \"Tarikh.Luput.Lesen\"       \"Tarikh.Pembatalan.lesen\" \r\n[11] \"Jenis.Perniagaan\"        \r\n\r\nSince the data is published by an official government portal, there should be no missing data but it doesn’t hurt to check.\r\n\r\n\r\nwhich(is.na(PG$Nama.Premis))\r\n\r\n\r\ninteger(0)\r\n\r\nwhich(is.na(PG$Alamat.Premis))\r\n\r\n\r\ninteger(0)\r\n\r\nOnce data completeness has been confirmed, I can move on to prepare the data for mapping.\r\nGIS package in R\r\nI am mainly using the mapview() package and ggmap() package\r\nThe first step is to convert the the address to latitude and longtidue. This is done by using the geocode() function.\r\nNote that geocoding requires tools that may not be free. Most notably is the Google Maps API that requires an account on the Google Cloud Platform in order to work. I am using a mixed of the public API by OpenStreetMap called Nominatim and Google Maps API.\r\nThe following codes are used to convert addresses to latitude and longitude. I used cascade_oder=c(\"osm\",\"google\") to order first geocoding services with Nominatim followed by Google Maps service.\r\n\r\n\r\nlibrary(ggmap)\r\n\r\nlat_longs3 <- PG %>%\r\n    geocode(Alamat.Premis, method = \"cascade\", cascade_order = c(\"osm\",\r\n        \"google\"), lat = latitude, long = longitude)\r\n\r\n\r\n\r\nSometimes the geocoding process will fail to produce any coordinates and subsequent mapping cannot proceed. In this case, the coordinates will be manually identified and filled.\r\nMapping pharmacies\r\nAs the coordinates of the pharmacies are complete now, I can proceed to map their locations for subsequent analysis.\r\n\r\n\r\n\r\nThe next step is to convert the coordinates into sf objects with st_as_sf() command (of the sf() package)\r\n\r\n\r\nlibrary(sf)\r\n\r\npg_sf <- st_as_sf(lat_longs3, coords = c(\"longitude\", \"latitude\"), crs=4326)\r\n\r\n\r\n\r\nTo map these pharmacies, the package mapview() will be needed. I opted to use the colour palette from the package RColorBrewer.\r\n\r\n\r\nlibrary(mapview)\r\nlibrary(RColorBrewer)\r\n\r\npg_pharm <- mapview(pg_sf, zcol = c(\"Nama.Premis\"), legend = FALSE,\r\n    layer.name = \"Retail & Wholesale Pharmacies in Penang\", col.regions = brewer.pal(9,\r\n        \"Reds\"))\r\n\r\n\r\n\r\nThe distribution of all retail & wholesale pharmacies in Penang state is shown below. Each colour dot represents a pharmacy.\r\n\r\n\r\n{\"x\":{\"options\":{\"minZoom\":1,\"maxZoom\":52,\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}},\"preferCanvas\":false,\"bounceAtZoomLimits\":false,\"maxBounds\":[[[-90,-370]],[[90,370]]]},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",\"CartoDB.Positron\",\"CartoDB.Positron\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.DarkMatter\",\"CartoDB.DarkMatter\",\"CartoDB.DarkMatter\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"OpenStreetMap\",\"OpenStreetMap\",\"OpenStreetMap\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldImagery\",\"Esri.WorldImagery\",\"Esri.WorldImagery\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"OpenTopoMap\",\"OpenTopoMap\",\"OpenTopoMap\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"createMapPane\",\"args\":[\"point\",440]},{\"method\":\"addFlatGeoBuf\",\"args\":[\"Retail&WholesalePharmaciesinPenang\",\"Retail & Wholesale Pharmacies in Penang\",null,true,\"Nama.Premis\",{\"radius\":6,\"stroke\":true,\"color\":\"#333333\",\"weight\":1,\"opacity\":0.9,\"fill\":true,\"fillColor\":null,\"fillOpacity\":0.6},{\"className\":\"\",\"pane\":\"point\"},\"mapview-popup\",{\"radius\":{\"to\":[3,15],\"from\":[3,15]},\"weight\":{\"to\":[1,10],\"from\":[1,10]},\"opacity\":{\"to\":[0,1],\"from\":[0,1]},\"fillOpacity\":{\"to\":[0,1],\"from\":[0,1]}}]},{\"method\":\"addScaleBar\",\"args\":[{\"maxWidth\":100,\"metric\":true,\"imperial\":true,\"updateWhenIdle\":true,\"position\":\"bottomleft\"}]},{\"method\":\"addHomeButton\",\"args\":[100.2005069,5.1420961,100.5429423,5.5706471,true,\"Retail & Wholesale Pharmacies in Penang\",\"Zoom to Retail & Wholesale Pharmacies in Penang\",\"<strong> Retail & Wholesale Pharmacies in Penang <\\/strong>\",\"bottomright\"]},{\"method\":\"addLayersControl\",\"args\":[[\"CartoDB.Positron\",\"CartoDB.DarkMatter\",\"OpenStreetMap\",\"Esri.WorldImagery\",\"OpenTopoMap\"],\"Retail & Wholesale Pharmacies in Penang\",{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topleft\"}]}],\"fitBounds\":[5.1420961,100.2005069,5.5706471,100.5429423,[]]},\"evals\":[],\"jsHooks\":{\"render\":[{\"code\":\"function(el, x, data) {\\n  return (\\n      function(el, x, data) {\\n      // get the leaflet map\\n      var map = this; //HTMLWidgets.find('#' + el.id);\\n      // we need a new div element because we have to handle\\n      // the mouseover output separately\\n      // debugger;\\n      function addElement () {\\n      // generate new div Element\\n      var newDiv = $(document.createElement('div'));\\n      // append at end of leaflet htmlwidget container\\n      $(el).append(newDiv);\\n      //provide ID and style\\n      newDiv.addClass('lnlt');\\n      newDiv.css({\\n      'position': 'relative',\\n      'bottomleft':  '0px',\\n      'background-color': 'rgba(255, 255, 255, 0.7)',\\n      'box-shadow': '0 0 2px #bbb',\\n      'background-clip': 'padding-box',\\n      'margin': '0',\\n      'padding-left': '5px',\\n      'color': '#333',\\n      'font': '9px/1.5 \\\"Helvetica Neue\\\", Arial, Helvetica, sans-serif',\\n      'z-index': '700',\\n      });\\n      return newDiv;\\n      }\\n\\n\\n      // check for already existing lnlt class to not duplicate\\n      var lnlt = $(el).find('.lnlt');\\n\\n      if(!lnlt.length) {\\n      lnlt = addElement();\\n\\n      // grab the special div we generated in the beginning\\n      // and put the mousmove output there\\n\\n      map.on('mousemove', function (e) {\\n      if (e.originalEvent.ctrlKey) {\\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n      lnlt.text(\\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n                           ' | zoom: ' + map.getZoom() +\\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\\n                           ' | epsg: 3857 ' +\\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\\n      } else {\\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n      lnlt.text(\\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n                      ' | zoom: ' + map.getZoom() + ' ');\\n      }\\n      });\\n\\n      // remove the lnlt div when mouse leaves map\\n      map.on('mouseout', function (e) {\\n      var strip = document.querySelector('.lnlt');\\n      if( strip !==null) strip.remove();\\n      });\\n\\n      };\\n\\n      //$(el).keypress(67, function(e) {\\n      map.on('preclick', function(e) {\\n      if (e.originalEvent.ctrlKey) {\\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n      lnlt.text(\\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n                      ' | zoom: ' + map.getZoom() + ' ');\\n      var txt = document.querySelector('.lnlt').textContent;\\n      console.log(txt);\\n      //txt.innerText.focus();\\n      //txt.select();\\n      setClipboardText('\\\"' + txt + '\\\"');\\n      }\\n      });\\n\\n      }\\n      ).call(this.getMap(), el, x, data);\\n}\",\"data\":null},{\"code\":\"function(el, x, data) {\\n  return (function(el,x,data){\\n           var map = this;\\n\\n           map.on('keypress', function(e) {\\n               console.log(e.originalEvent.code);\\n               var key = e.originalEvent.code;\\n               if (key === 'KeyE') {\\n                   var bb = this.getBounds();\\n                   var txt = JSON.stringify(bb);\\n                   console.log(txt);\\n\\n                   setClipboardText('\\\\'' + txt + '\\\\'');\\n               }\\n           })\\n        }).call(this.getMap(), el, x, data);\\n}\",\"data\":null}]}}\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-08-17T13:20:58+08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-05-04-survival-analysis/",
    "title": "Survival Analysis",
    "description": "This is a note to myself on survival analysis. You are welcome to use the information.",
    "author": [
      {
        "name": "WenYao, Mak",
        "url": "https://www.linkedin.com/in/mak-wen-yao-51148154/"
      }
    ],
    "date": "2021-05-04",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nComprehensive Survival Analysis in R\r\nPart 1: Survival vs Hazard Functions (Probabilities)\r\nGraphical representation of the survival function\r\n\r\n\r\nComprehensive Survival Analysis in R\r\nThe article introduces different analysis methods for time-to-event data, and how to conduct these analyses using R.\r\nMy current research interest revolves around peritoneal dialysis and related issues, so examples will be illustrated using data in this field.\r\nPart 1: Survival vs Hazard Functions (Probabilities)\r\nWe often are interested in how long a person can undergo peritoneal dialysis (PD) without suffering infections to their peritoneum (which causes inflamation, i.e. peritonitis).\r\nThe probability that a person can stay peritonitis-free, or survive the time from the start of PD treatment to a specific time t in the future, is the survival probability. This is represented by the survivor function S(t), as below:\r\n\\[S(t)=Pr(T>t)\\] The function indicates the population probability of surviving beyond time t.\r\nGraphical representation of the survival function\r\nThe survival function can be depicted as a survival curve. This is more intuitive to understand the probability of surviving (or in our case, remain peritonitis-free) beyond a certain time t.\r\n\r\nCall: survfit(formula = Surv(time, event) ~ sex, data = kaplan)\r\n\r\n       n events median 0.95LCL 0.95UCL\r\nsex=1 46     18    869     421      NA\r\nsex=2 54     18   1353     632      NA\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-05-04-survival-analysis/survival-analysis_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-01-12T13:45:59+08:00",
    "input_file": "survival-analysis.knit.md",
    "preview_width": 1248,
    "preview_height": 768
  },
  {
    "path": "posts/welcome/",
    "title": "Welcome to My Blog",
    "description": "Welcome to my blog! I hope the information can help you in your journey in Data Science.",
    "author": [
      {
        "name": "WenYao Mak",
        "url": "https://www.linkedin.com/in/mak-wen-yao-51148154/"
      }
    ],
    "date": "2021-04-17",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2022-01-12T12:52:55+08:00",
    "input_file": "welcome.knit.md"
  }
]
